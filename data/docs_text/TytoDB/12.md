# Operation Structures
1. Create Container Opcode: 0x00
The byte stream begins with the opcode 0x00. It is followed by the container name, encoded as a single u8 for its length and then the name's raw ASCII bytes. Next, a single u8 specifies the number of columns (C). This is followed by a sequence of C column name definitions, where each name is individually prefixed by its u8 length. Finally, a contiguous block of C bytes is appended, where each byte is the u8 Type ID for the corresponding column in the order they were defined.

2. Create Row Opcode: 0x01
The stream starts with opcode 0x01. It is followed by the container name, encoded as a u8-prefixed string. Next, a u8 indicates the number of columns (C) for which values are being provided. This is followed by C column names, each encoded as a u8-prefixed string. Finally, a sequence of C values are appended, with each value being fully serialized according to its `AlbaType` structure (Type ID + data).

3. Edit Row Opcode: 0x02
The stream begins with opcode 0x02, followed by the u8-prefixed container name. After the name, a u8 specifies the number of changes (C). This is followed by C pairs of a u8-prefixed column name and a fully serialized `AlbaType` value. After the changes block, a complete Condition Block is appended to specify which rows to update.

4. Delete Row Opcode: 0x03
The instruction starts with opcode 0x03, followed by the u8-prefixed container name. A single byte flag follows; if it is 0x01, a complete Condition Block is appended. If the flag is 0x00, no further data is present, indicating a deletion of all rows (if supported by the server's query plan).

5. Delete Container Opcode: 0x04
This instruction starts with opcode 0x04. It is immediately followed by the raw ASCII bytes of the container name. It is critical to note that this is an exceptional case: the container name is not prefixed with its length.

6. Search Opcode: 0x05
The search instruction is uniquely structured. It begins with opcode 0x05. This is followed by a u8 indicating the number of columns to fetch (C), then C instances of u8-prefixed column names. After the column names, a complete Condition Block is appended. Following the conditions, an 8-byte u64 specifies the length (L) of the final data block. This final block contains the target container, encoded as a standard u8-prefixed string.

7. Commit Opcode: 0x06
Starts with opcode 0x06. A 1-byte flag follows: if 0x01, a u8-prefixed container name is appended to commit changes only for that container. If 0x00, no more data follows, and the commit applies to all containers with pending changes.

8. Rollback Opcode: 0x07
Starts with opcode 0x07. A 1-byte flag follows: if 0x01, a u8-prefixed container name is appended to roll back changes for that container only. If 0x00, the rollback is for all containers.

9. Batch Create Rows Opcode: 0x08
The instruction begins with opcode 0x08, followed by a u8-prefixed container name. Next, a u8 specifies the number of columns (C), followed by C u8-prefixed column names. After the schema information, a 4-byte u32 indicates the number of rows (R) in the batch. Finally, a flattened sequence of R * C values, each serialized as a complete `AlbaType`, is appended.

10. Batch Opcode: 0x09
This instruction starts with opcode 0x09. It is followed by a 4-byte signed integer (i32). The absolute value of this integer represents the number of commands (C) in the batch. If the integer is negative, the entire batch should be executed as a single transaction. The integer is followed by C command blocks. Each block consists of a 4-byte u32 indicating the length of the subsequent command's byte stream, followed by the complete byte stream of that command (including its own opcode and data).

Implementation Constraints
The serialization logic imposes the following maximum sizes:

Container names are limited to 100 bytes (MAX_CONTAINER_NAME_LENGTH).
Column names are limited to 25 bytes (MAX_CONTAINER_COLUMN_LENGTH).
The number of columns in a container is limited to 255 (u8::MAX).
The number of conditions in a single operation is limited to 255 (u8::MAX).


```
+----------------------------+
| 0x00 Create Container      |
+----------------------------+
| Opcode (0x00)             |
| Container Name (u8 + ASCII)|
| Num Columns (C, u8)        |
| [Column Name (u8 + ASCII)]*C|
| [Column Type ID (u8)]*C    |
+----------------------------+

+----------------------------+
| 0x01 Create Row            |
+----------------------------+
| Opcode (0x01)             |
| Container Name (u8 + ASCII)|
| Num Columns (C, u8)        |
| [Column Name (u8 + ASCII)]*C|
| [Value (AlbaType)]*C       |
+----------------------------+

+----------------------------+
| 0x02 Edit Row              |
+----------------------------+
| Opcode (0x02)             |
| Container Name (u8 + ASCII)|
| Num Changes (C, u8)        |
| [(Column Name + AlbaType)]*C|
| Condition Block            |
+----------------------------+

+----------------------------+
| 0x03 Delete Row            |
+----------------------------+
| Opcode (0x03)             |
| Container Name (u8 + ASCII)|
| Flag (0x00=all / 0x01=cond)|
| [Condition Block if flag=1]|
+----------------------------+

+----------------------------+
| 0x04 Delete Container      |
+----------------------------+
| Opcode (0x04)             |
| Container Name (ASCII, raw)|
+----------------------------+

+----------------------------+
| 0x05 Search                |
+----------------------------+
| Opcode (0x05)             |
| Num Columns (C, u8)        |
| [Column Name (u8 + ASCII)]*C|
| Condition Block            |
| Data Block Length (u64)    |
| Target Container (u8 + ASCII)|
+----------------------------+

+----------------------------+
| 0x06 Commit                |
+----------------------------+
| Opcode (0x06)             |
| Flag (0x00=all / 0x01=container)|
| [Container Name if flag=1]|
+----------------------------+

+----------------------------+
| 0x07 Rollback              |
+----------------------------+
| Opcode (0x07)             |
| Flag (0x00=all / 0x01=container)|
| [Container Name if flag=1]|
+----------------------------+

+----------------------------+
| 0x08 Batch Create Rows     |
+----------------------------+
| Opcode (0x08)             |
| Container Name (u8 + ASCII)|
| Num Columns (C, u8)        |
| [Column Name (u8 + ASCII)]*C|
| Num Rows (R, u32)          |
| [Values (AlbaType)]*(R*C)  |
+----------------------------+

+----------------------------+
| 0x09 Batch                 |
+----------------------------+
| Opcode (0x09)             |
| Num Commands (i32, abs= C) |
| (Negative = single txn)    |
| [Command Length (u32) + Command Bytes]*C|
+----------------------------+

```